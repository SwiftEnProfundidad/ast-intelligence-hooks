#!/usr/bin/env bash
# =============================================================================
# Git Flow Helper Script
# =============================================================================
# Usage: gitflow [check|status|workflow|reset]
# =============================================================================

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
ENFORCER="${SCRIPT_DIR}/../infrastructure/shell/gitflow/gitflow-enforcer.sh"

if [[ ! -f "$ENFORCER" ]]; then
  ENFORCER="${SCRIPT_DIR}/../infrastructure/shell/gitflow-enforcer.sh"
fi

if [[ ! -f "$ENFORCER" ]]; then
  echo "‚ùå Error: gitflow-enforcer.sh not found"
  echo "   Expected at: $ENFORCER"
  exit 1
fi

SUBCOMMAND="${1:-check}"
case "$SUBCOMMAND" in
  status)
    SUBCOMMAND="check"
    ;;
  workflow)
    SUBCOMMAND="cycle"
    ;;
  reset)
    SUBCOMMAND="cleanup"
    ;;
esac

bash "$ENFORCER" "$SUBCOMMAND"
